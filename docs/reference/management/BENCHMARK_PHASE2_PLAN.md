# Benchmark模块 Phase 2 迁移计划

**创建日期:** 2026-01-21
**状态:** 待批准
**目标:** 整合对比系统，消除重复代码

---

## 一、迁移策略概要

### 方案A: 现有系统为主（推荐）

**核心原则:**
1. 保留独特优势 - 两个系统的优点都要保留
2. 消除重复代码 - 删除完全重复的功能
3. 统一接口 - 提供一致的API
4. 向后兼容 - 不破坏现有代码

### 迁移步骤（6个子阶段）

**Phase 2.1:** 扩展evaluators/ - 添加高级聚类指标
**Phase 2.2:** 扩展competitor系统 - 添加Scanpy支持
**Phase 2.3:** 整合可视化系统 - 统一样式管理
**Phase 2.4:** 添加报告生成 - Markdown报告
**Phase 2.5:** 删除重复文件 - 4个文件
**Phase 2.6:** 更新导入和测试 - 验证功能

---

## 二、待删除文件清单

### 完全删除（3个文件）
1. ❌ `comparison_viz.py` (776行) - 功能已整合到 competitor_viz.py
2. ❌ `report_generator.py` (548行) - 功能已整合到 display/report/
3. ❌ `run_scanpy_comparison.py` (311行) - 功能已合并

### 部分保留（1个文件）
4. 📝 `comparison_engine.py` (438行) - 保留Scanpy专用逻辑，删除重复部分

---

## 三、新增功能清单

### 3.1 高级评估指标（Phase 2.1）
- ✅ 聚类一致性指标（ARI、NMI、Silhouette）
- ✅ PCA方差解释对比
- ✅ UMAP嵌入质量对比

### 3.2 Scanpy竞争对手（Phase 2.2）
- ✅ Scanpy PCA方法
- ✅ Scanpy K-means方法
- ✅ Scanpy UMAP方法

### 3.3 专业可视化（Phase 2.3）
- ✅ 模块化颜色主题系统
- ✅ 多种绘图风格（science、ieee、nature）
- ✅ 聚类一致性图表
- ✅ PCA方差对比图表

### 3.4 报告生成（Phase 2.4）
- ✅ Markdown格式报告
- ✅ 中文内容支持
- ✅ 自动摘要生成

---

## 四、预期成果

| 指标 | 迁移前 | 迁移后 | 变化 |
|------|--------|--------|------|
| 总行数 | 19,969 | ~18,900 | -5% |
| 文件数 | 14 | 11 | -21% |
| 重复代码 | ~1,500 | 0 | -100% |
| 功能完整性 | 100% | 100% | 保持 |

---

## 五、时间估算

| 阶段 | 时间 |
|------|------|
| Phase 2.1: 扩展评估指标 | 1-2小时 |
| Phase 2.2: 扩展Competitor系统 | 1-2小时 |
| Phase 2.3: 整合可视化系统 | 2-3小时 |
| Phase 2.4: 添加报告生成 | 1小时 |
| Phase 2.5: 删除重复文件 | 30分钟 |
| Phase 2.6: 更新导入和测试 | 1小时 |
| **总计** | **6.5-9.5小时** |

---

## 六、需要确认

**请用户确认:**

- [ ] 同意采用方案A（现有系统为主）
- [ ] 同意删除上述4个文件
- [ ] 同意分6个子阶段执行
- [ ] 同意保留所有现有功能

**确认后请回复: "同意，开始Phase 2迁移"**
