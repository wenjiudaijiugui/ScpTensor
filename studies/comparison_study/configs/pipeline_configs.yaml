# Pipeline Configuration File
# Defines 5 representative single-cell proteomics analysis pipelines

# Global settings
global:
  random_seed: 42
  n_workers: 4
  verbose: true

# Pipeline A: Classic Pipeline (most common in literature)
pipeline_a:
  name: "Classic Pipeline"
  description: "QC → Median normalization → Log transform → KNN imputation → No batch correction → PCA → K-means"
  color: "#1f77b4"

  steps:
    # Step 1: Quality Control
    qc:
      enabled: true
      method: "basic"
      params:
        min_cells_per_feature: 3
        min_features_per_cell: 100

    # Step 2: Normalization
    normalization:
      enabled: true
      method: "median"
      params:
        target_layer: "raw"

    # Step 3: Log transform
    log_transform:
      enabled: true
      params:
        base: 2.0
        offset: 1.0

    # Step 4: Imputation
    imputation:
      enabled: true
      method: "knn"
      params:
        n_neighbors: 5
        metric: "euclidean"

    # Step 5: Batch correction
    batch_correction:
      enabled: false

    # Step 6: Dimensionality reduction
    dim_reduction:
      enabled: true
      method: "pca"
      params:
        n_components: 50
        center: true

    # Step 7: Clustering
    clustering:
      enabled: true
      method: "kmeans"
      params:
        n_clusters: 8
        random_state: 42

# Pipeline B: Batch Correction Pipeline (for multi-batch data)
pipeline_b:
  name: "Batch Correction Pipeline"
  description: "QC → Median normalization → Log transform → KNN imputation → ComBat → PCA → K-means"
  color: "#ff7f0e"

  steps:
    qc:
      enabled: true
      method: "basic"
      params:
        min_cells_per_feature: 3
        min_features_per_cell: 100

    normalization:
      enabled: true
      method: "median"
      params:
        target_layer: "raw"

    log_transform:
      enabled: true
      params:
        base: 2.0
        offset: 1.0

    imputation:
      enabled: true
      method: "knn"
      params:
        n_neighbors: 5
        metric: "euclidean"

    batch_correction:
      enabled: true
      method: "combat"
      params:
        batch_key: "batch"

    dim_reduction:
      enabled: true
      method: "pca"
      params:
        n_components: 50
        center: true

    clustering:
      enabled: true
      method: "kmeans"
      params:
        n_clusters: 8
        random_state: 42

# Pipeline C: Advanced Pipeline (with latest methods)
pipeline_c:
  name: "Advanced Pipeline"
  description: "QC → Quantile normalization → Log transform → MissForest imputation → Harmony → UMAP → Leiden"
  color: "#2ca02c"

  steps:
    qc:
      enabled: true
      method: "basic"
      params:
        min_cells_per_feature: 3
        min_features_per_cell: 100

    normalization:
      enabled: true
      method: "quantile"
      params:
        target_layer: "raw"

    log_transform:
      enabled: true
      params:
        base: 2.0
        offset: 1.0

    imputation:
      enabled: true
      method: "missforest"
      params:
        n_estimators: 100
        max_iter: 10

    batch_correction:
      enabled: true
      method: "harmony"
      params:
        batch_key: "batch"
        lambda_param: 1.0

    dim_reduction:
      enabled: true
      method: "umap"
      params:
        n_components: 2
        n_neighbors: 15
        min_dist: 0.1

    clustering:
      enabled: true
      method: "leiden"
      params:
        resolution: 1.0
        n_neighbors: 15

# Pipeline D: Performance-Optimized Pipeline (for large-scale data)
pipeline_d:
  name: "Performance-Optimized Pipeline"
  description: "QC → Z-score normalization → Lazy validation → SVD imputation → MNN correction → PCA → K-means"
  color: "#d62728"

  steps:
    qc:
      enabled: true
      method: "basic"
      params:
        min_cells_per_feature: 3
        min_features_per_feature: 100

    normalization:
      enabled: true
      method: "zscore"
      params:
        target_layer: "raw"

    lazy_validation:
      enabled: true
      params:
        validate_on_access: true

    imputation:
      enabled: true
      method: "svd"
      params:
        n_components: 20

    batch_correction:
      enabled: true
      method: "mnn"
      params:
        batch_key: "batch"
        k: 20

    dim_reduction:
      enabled: true
      method: "pca"
      params:
        n_components: 50
        center: true

    clustering:
      enabled: true
      method: "kmeans"
      params:
        n_clusters: 8
        random_state: 42

# Pipeline E: Conservative Pipeline (minimal assumptions)
pipeline_e:
  name: "Conservative Pipeline"
  description: "QC → VSN normalization → Log transform → PPCA imputation → No batch correction → PCA → K-means"
  color: "#9467bd"

  steps:
    qc:
      enabled: true
      method: "basic"
      params:
        min_cells_per_feature: 3
        min_features_per_cell: 100

    normalization:
      enabled: true
      method: "vsn"
      params:
        target_layer: "raw"

    log_transform:
      enabled: true
      params:
        base: 2.0
        offset: 1.0

    imputation:
      enabled: true
      method: "ppca"
      params:
        n_components: 20

    batch_correction:
      enabled: false

    dim_reduction:
      enabled: true
      method: "pca"
      params:
        n_components: 50
        center: true

    clustering:
      enabled: true
      method: "kmeans"
      params:
        n_clusters: 8
        random_state: 42
